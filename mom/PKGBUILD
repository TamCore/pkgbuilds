# Maintainer: Philipp 'TamCore' B. <philipp {at} tamcore {dot} eu>

pkgname=mom
pkgver=4.1.14
pkgrel=1
pkgdesc="Management interface software for products offered by OVH" 
url="https://www.ovh.com/fr/support/outils/mom.xml"
license=('custom' 'LGPL2.1')
arch=('i686' 'x86_64')
changelog=ChangeLog
depends=('krb5' 'fontconfig' 'libsm' 'libxext' 'libxrender' 'gcc-libs' 'xdg-utils')
source=(ftp://ftp.ovh.net/MoM/MoM-${pkgver}.tar.gz mom.desktop mom.xpm mom_dotfile.patch)
md5sums=('95cea366cbc2e9ee7ccd8b9121ce5467'
         'b24f40485459f0f613bc7dcd863ab941'
         '339ef7af508acd58822e3ee8d16920af'
         '8ac5191d36da6b56034f4ddbe5bb22d3')

[ "$CARCH" = "x86_64" ] && depends=('lib32-krb5' 'lib32-fontconfig' 'lib32-libsm' 'lib32-libxext' 'lib32-libxrender' 'lib32-gcc-libs' 'xdg-utils')


build() {
    cd "$srcdir/MoM"
    install -d -m 755 $pkgdir/usr/{bin,lib/mom}
    install -d -m 755 $pkgdir/usr/share/{pixmaps,applications,licenses/mom}

    # Qt provide : imageformats/libqgif.so
    patch -Np0 < $srcdir/mom_dotfile.patch
}

package() {
    cd "$srcdir/MoM"

    install -m 644 $startdir/mom.xpm $pkgdir/usr/share/pixmaps
    install -m 644 $startdir/mom.desktop $pkgdir/usr/share/applications

    cd $srcdir/MoM/licenses
    install -D -m 644 license-en.txt $pkgdir/usr/share/licenses/mom/LICENSE

    install -m 755 $srcdir/MoM/MoM $pkgdir/usr/bin/mom
    install -m 755 $srcdir/MoM/.MoM-bin $pkgdir/usr/bin/mom-bin

    install -m 755 $srcdir/MoM/.lib/* $pkgdir/usr/lib/mom/
}
